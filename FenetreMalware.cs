using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace _25_26_PrograEvent_Seance2
{
    public partial class FenetreMalware : Form
    {
        static int nbrFenetre = 0;
        static int nbrFenetreMax = 30;
        Random r = new Random();

        public FenetreMalware()
        {
            InitializeComponent();
            nbrFenetre++;
            timer1.Interval = 1000;
            timer1.Tick += timer1_Tick;
            timer1.Start();

            timer2.Interval = 1000;
            timer2.Tick += timer2_Tick;
            timer2.Start();
        }



        private void FenetreMalware_Load(object sender, EventArgs e)
        {
            this.TopMost = true;
            this.FormClosing += FenetreMalware_FormClosing;
            this.MouseEnter += FenetreMalware_MouseEnter;
        }
        private void FenetreMalware_FormClosing(object sender, FormClosingEventArgs e)
        {
            e.Cancel = true;
            FenetreMalware fenetreMalware = new FenetreMalware();
            fenetreMalware.Show();
        }
        private void FenetreMalware_MouseEnter(object sender, EventArgs e)
        {
            Random rand = new Random();
            int x = rand.Next(0, Screen.PrimaryScreen.WorkingArea.Width - this.Width);
            int y = rand.Next(0, Screen.PrimaryScreen.WorkingArea.Height - this.Height);
            this.Location = new Point(x, y);
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            if (nbrFenetre < nbrFenetreMax)
            {
                FenetreMalware fenetreMalware = new FenetreMalware();
                fenetreMalware.Show();
            }
        }

        private void timer2_Tick(object sender, EventArgs e)
        {
            JouerSon();
            string[] messages =
            {
                "Mémoire corrompue",
                "Erreur critique",
                "Virus détecté",
                "Accès refusé",
                "Impossible de continuer",
                "Fichier système endommagé"
            };
            MessageBox.Show(messages[r.Next(messages.Length)]);
        }





        private void JouerSon()
        {
            int choix = r.Next(5);
            switch (choix)
            {
                case 0:
                    System.Media.SystemSounds.Beep.Play();
                    break;
                case 1:
                    System.Media.SystemSounds.Asterisk.Play();
                    break;
                case 2:
                    System.Media.SystemSounds.Exclamation.Play();
                    break;
                case 3:
                    System.Media.SystemSounds.Hand.Play();
                    break;
                case 4:
                    System.Media.SystemSounds.Question.Play();
                    break;
            }
        }
    }
}
